<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Welcome to Scriptorum</title>
    <!-- Use a locally built Tailwind CSS file for production: /static/css/tailwind.css -->
    <link rel="stylesheet" href="/static/css/tailwind.css">
    <link rel="icon" href="/static/icon.svg" type="image/svg+xml" />
    <link rel="manifest" href="/static/site.webmanifest" />
    <meta name="theme-color" content="#0b0b13" />
    <style>html,body{height:100%;}</style>
    {{if .AutoRedirect}}
    <script>
        {{if .Debug}}
        console.log('AutoRedirect is true, will redirect in 1 second');
        {{end}}
        // Wait 1 second then redirect to OAuth for proper URL loading in social media
        setTimeout(function() {
            {{if .Debug}}
            console.log('Redirecting to OAuth...');
            {{end}}
            window.location.href = '/oauth/login';
        }, 1000);
    </script>
    {{else}}
    {{if .Debug}}
    <script>
        console.log('AutoRedirect is false');
        console.log('OAuthEnabled: {{.OAuthEnabled}}');
        console.log('FromLogout: {{.FromLogout}}');
        console.log('ForceLocal: {{.ForceLocal}}');
    </script>
    {{end}}
    {{end}}
  </head>
  <body class="min-h-screen bg-night-900 text-slate-100">
  <div class="min-h-screen bg-gradient-to-br from-night-900 via-surface-100 to-night-800 flex items-center justify-center px-4">
    <div class="max-w-md w-full space-y-8">
      <div class="text-center">
        <!-- Scriptorum Icon -->
        <div class="mx-auto w-24 h-24 mb-6 flex items-center justify-center">
          <img src="/static/icon.svg" alt="Scriptorum" class="w-full h-full" />
        </div>
      
        <!-- Welcome Text -->
        <h1 class="text-4xl font-bold text-white mb-2">Welcome to</h1>
        <h2 class="text-5xl font-bold bg-gradient-to-r from-royal-400 to-royal-300 bg-clip-text text-transparent mb-8">
          Scriptorum
        </h2>
        <p class="text-slate-300 text-lg mb-8">Your digital library awaits</p>
      </div>

      <!-- Login Options -->
      <div class="space-y-4">
        {{if .OAuthEnabled}}
          <!-- OAuth Login Button -->
          <a href="/oauth/login" 
             class="w-full flex justify-center py-3 px-6 border border-transparent rounded-xl text-lg font-medium text-white bg-gradient-to-r from-royal-600 to-royal-500 hover:from-royal-500 hover:to-royal-400 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-royal-500 shadow-card transition-all duration-200 hover:shadow-glow">
            <svg class="w-5 h-5 mr-2 mt-0.5" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path>
            </svg>
            Login with OAuth
          </a>
        {{else}}
          <!-- Local Login Form (OAuth Disabled) -->
          <div class="space-y-4 p-6 bg-night-800/50 rounded-xl border border-white/10">
            {{if .LoginError}}
            <div class="p-3 bg-red-900/50 border border-red-600/50 rounded-lg text-red-200 text-sm">
              {{.LoginError}}
            </div>
            {{end}}
            <form method="post" action="/login">
              <input type="hidden" name="_csrf_token" value="{{.CSRFToken}}">
              <div class="space-y-3">
                <div>
                  <label for="username" class="block text-sm font-medium text-slate-200 mb-1">Username</label>
                  <input name="username" type="text" required 
                         value="{{.Username}}"
                         class="w-full px-3 py-2 border border-white/20 rounded-lg bg-night-900 text-slate-100 placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-royal-500 focus:border-transparent">
                </div>
                <div>
                  <label for="password" class="block text-sm font-medium text-slate-200 mb-1">Password</label>
                  <input name="password" type="password" required 
                         class="w-full px-3 py-2 border border-white/20 rounded-lg bg-night-900 text-slate-100 placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-royal-500 focus:border-transparent">
                </div>
                <button type="submit" 
                        class="w-full py-2 px-4 rounded-lg bg-royal-600 text-white hover:bg-royal-500 focus:outline-none focus:ring-2 focus:ring-royal-500 transition-colors duration-200">
                  Sign In
                </button>
              </div>
            </form>
          </div>
        {{end}}
      </div>

      <!-- Footer -->
      <div class="text-center text-slate-400 text-xs">
        <p>Scriptorum &copy; {{.CurrentYear}}</p>
      </div>
    </div>
  </div>
  </body>
  </html>
